<% include partials/header.ejs %>
    <div class="table-wrapper">
        <% if (clients.length > 0) {%>
            <table class="table table-hovered">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Prenom</th>
                        <th scope="col">Nom</th>
                    </tr>
                </thead>
                <tbody>
                    <% clients.forEach((client, index) => { %>
                        <tr>
                            <th scope="row"><%= client.id_client %></th>
                            <td><%= client.prenom %></td>
                            <td><%= client.nom %></td>
                            <td>
                                <a href="/client/<%= client.id_client %>"  class="btn btn-sm btn-success">Modifier</a>
                                <a href="/delete/<%= client.id_client %>" class="btn btn-sm btn-danger">Supprimer</a>
                                <button class="deleteBtn" class="btn btn-sm btn-danger" data-id="<%= client.id_client %>" > XXX </button>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        <% } %>
    </div>
</body>
</html>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
    $(document).ready(function() {
        $('.deleteBtn').on("click", function(e){
            e.preventDefault();
            const id = $(this).attr('data-id');

            $.ajax({
                url: '/client/' + id,
                method: 'DELETE',
                data: { id: id }
                }).done(function(res) {
                    if (res.success) {
                    console.log('id from ajax call is', res);
                    window.location.reload();
                } else {
                    console.log('error...ajax');
                }});
        })
    })
</script>

